{"ast":null,"code":"import * as TodayPreviewActions from './store/today-preview.actions';\nimport * as SearchActions from '../search/store/search.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../spinner/spinner.component\";\nfunction TodayPreviewComponent_app_spinner_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-spinner\");\n  }\n}\nfunction TodayPreviewComponent_p_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction TodayPreviewComponent_div_9_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14)(1, \"span\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \"\\u00B0C\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 1, ctx_r0.todayWeather.the_temp, \"1.0-0\"));\n  }\n}\nfunction TodayPreviewComponent_div_9_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14)(1, \"span\", 15);\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"celsiusToFarenheit\");\n    i0.ɵɵpipe(4, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5, \"\\u00B0F\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(4, 3, i0.ɵɵpipeBind1(3, 1, ctx_r0.todayWeather.the_temp), \"1.0-0\"));\n  }\n}\nfunction TodayPreviewComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 10);\n    i0.ɵɵelement(2, \"img\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, TodayPreviewComponent_div_9_p_3_Template, 5, 4, \"p\", 12)(4, TodayPreviewComponent_div_9_p_4_Template, 6, 6, \"p\", 12);\n    i0.ɵɵelementStart(5, \"p\", 13);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"alt\", i0.ɵɵinterpolate(ctx_r0.todayWeather.weather_state_name))(\"src\", i0.ɵɵinterpolate1(\"../../assets/images/forecast/\", ctx_r0.todayWeather.weather_state_name, \".png\"), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.temperatureScaleCelsius);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.temperatureScaleCelsius);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.todayWeather.weather_state_name);\n  }\n}\nfunction TodayPreviewComponent_p_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"span\", 4);\n    i0.ɵɵtext(2, \"location_on\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.location.title);\n  }\n}\nexport let TodayPreviewComponent = /*#__PURE__*/(() => {\n  class TodayPreviewComponent {\n    constructor(store) {\n      this.store = store;\n      this.weatherForecast = [];\n    }\n    ngOnInit() {\n      this.dateTime = new Date();\n      this.storeSubscription = this.store.select('todayPreview').subscribe(responseData => {\n        this.location = responseData.location;\n        this.error = responseData.error;\n        this.weatherForecast = responseData.weather;\n        this.isLoading = responseData.isLocalising;\n        if (this.weatherForecast) {\n          this.todayWeather = this.weatherForecast[0];\n        }\n        console.log(this.weatherForecast);\n        this.temperatureScaleCelsius = responseData.isCelsius;\n      });\n    }\n    ngAfterContentInit() {\n      if (!this.weatherForecast) {\n        this.onGeolocalisation();\n      }\n    }\n    ngOnDestroy() {\n      this.storeSubscription.unsubscribe();\n    }\n    onSearch() {\n      this.store.dispatch(new SearchActions.SearchModeOn());\n    }\n    onGeolocalisation() {\n      this.store.dispatch(new TodayPreviewActions.StartLocation());\n      navigator.geolocation.getCurrentPosition(position => {\n        this.showPosition(position);\n      }, error => {\n        this.showError(error);\n      });\n    }\n    showPosition(position) {\n      this.latt = position.coords.latitude;\n      this.long = position.coords.longitude;\n      this.store.dispatch(new TodayPreviewActions.FindLocationDetails({\n        latt: this.latt,\n        long: this.long\n      }));\n    }\n    showError(error) {\n      if (error) {\n        this.error = 'It is not possible to geolocalize you. Please use the Search button to find tour position.';\n      }\n    }\n    static {\n      this.ɵfac = function TodayPreviewComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TodayPreviewComponent)(i0.ɵɵdirectiveInject(i1.Store));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: TodayPreviewComponent,\n        selectors: [[\"app-today-preview\"]],\n        standalone: false,\n        decls: 20,\n        vars: 7,\n        consts: [[4, \"ngIf\"], [1, \"toolbar\"], [1, \"square\", 3, \"click\"], [1, \"round\", 3, \"click\"], [1, \"material-icons\"], [1, \"weather\"], [1, \"footer\"], [\"id\", \"date\"], [1, \"bull\"], [\"id\", \"place\"], [1, \"image\"], [3, \"alt\", \"src\"], [\"class\", \"temp\", 4, \"ngIf\"], [1, \"state\"], [1, \"temp\"], [1, \"value\"]],\n        template: function TodayPreviewComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵtemplate(0, TodayPreviewComponent_app_spinner_0_Template, 1, 0, \"app-spinner\", 0);\n            i0.ɵɵelementStart(1, \"div\", 1)(2, \"button\", 2);\n            i0.ɵɵlistener(\"click\", function TodayPreviewComponent_Template_button_click_2_listener() {\n              return ctx.onSearch();\n            });\n            i0.ɵɵtext(3, \"Search for places\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"button\", 3);\n            i0.ɵɵlistener(\"click\", function TodayPreviewComponent_Template_button_click_4_listener() {\n              return ctx.onGeolocalisation();\n            });\n            i0.ɵɵelementStart(5, \"span\", 4);\n            i0.ɵɵtext(6, \"gps_fixed\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(7, \"div\", 5);\n            i0.ɵɵtemplate(8, TodayPreviewComponent_p_8_Template, 2, 1, \"p\", 0)(9, TodayPreviewComponent_div_9_Template, 7, 7, \"div\", 0);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"div\", 6)(11, \"div\", 7)(12, \"p\");\n            i0.ɵɵtext(13, \"Today \");\n            i0.ɵɵelementStart(14, \"span\", 8);\n            i0.ɵɵtext(15, \"\\u2022\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(16);\n            i0.ɵɵpipe(17, \"customDate\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(18, \"div\", 9);\n            i0.ɵɵtemplate(19, TodayPreviewComponent_p_19_Template, 4, 1, \"p\", 0);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.weatherForecast);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(17, 5, ctx.dateTime));\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.location);\n          }\n        },\n        dependencies: [i2.NgIf, i3.SpinnerComponent, i2.DecimalPipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return TodayPreviewComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}